<!DOCTYPE html>
<html>
    <style>
    div.slidecontainer {
        width: 100%;
        border: 1px solid black;    
    }
    div.plot-container plotly {
        width: 100%;  
    }
    table{
        width: 100%;
        border: 1px solid black;    

    }
    td { 
        width: 33%;
    }
    </style>
<body>
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<script type="text/javascript" 
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { fonts: ["TeX"] }
  });
</script>

<H1>Hastey</H1>
<H2>Metropolis Hastings algorithm implementation example to estimate relative frequencies of purines and pyrimidines</H2>

<table>
  <tr>
    <td> <div id="graph1" ></div> </td>

    <td class="slidecontainer"> 

      Number of samples: <input type="range" min=1 max=100000 value=10000 class="slider" id="TotalSamples"><br />
      Number of Observations: <input type="range" min=0 max=100 value=70 class="slider" id="TotalObserved"><br />
      True Proportion of Purines:<input type="range" min=0 max=1 value=0.2 step=0.01 class="slider" id="TrueTheta"> <br />
      Window size &delta;:<input type="range" min=0 max=1 value=0.1 step=0.01 class="slider" id="WindowSize"> <br />
      Burn In:<input type="range" min=0 max=100000 value=10000 step=1 class="slider" id="BurnIn"> <br />
      <button onclick="graph()" type="button">Simulate!</button>
      

    </td>
    <td id="Results">
        
        <p id="PostMean">
            
        </p>
        <p id="PostStd">
        
        </p>
    </td>
  </tr>
    <p>
    
    <button onclick="Preset1()" type="button">Preset 1</button>
    <button onclick="Preset2()" type="button">Preset 2</button>
    <button onclick="Preset3()" type="button">Preset 3</button>
    <button onclick="Preset4()" type="button">Preset 4</button>
    <button onclick="Select_Uniform()" type="button">Prior Uniform</button>
    <button onclick="Select_Jumpy()" type="button">Select Jumpy</button>
    <button onclick="rejectionGraph()" type="button">Rejection Sample Current Prior</button>
    <button onclick="importanceSample()" type="button">Importance Sample Current Prior</button>

    How do you check whether your Metropolis-Hastings approximation is good? <br />
    Repeat the simulation to "reassure" yourself of a good approximation. (But really you can't know for sure without infinite time)
    </p>

    1.
    Use Preset 1 -> Simulate!
    Lets assume that the prior p(&Theta;) is uniform between 0 and 1. Let &delta; = 0.1 and assume that 2 purines and 5 pyrimidines are our data.
    A random initial value works well. A 10000 burn-in period "calms" down some of the noise. We will use the average of all theta values after burn in as an estimate of the posterior mean.
    We will use the squared average of all squared theta values after burn in as an estimate of the posterior standard of deviation. <br />
    
    2.
    Use Preset 2 -> Simulate! to repeat the sampling with more observed data. 20 purines and 50 pyrimidines. <br />
    
    3.
    Use Preset 3 -> Simulate! to repeat the sampling with a small set of observations, and a more "Jumpy" prior distribution, defined by: 
    10/3 - (100/9)&Theta; when 0 <= &Theta; <= 0.3 and 100 &Theta; /49 - 30/49 when 0.3 <= &Theta; <= 1 (This places a difficult minimum near the true proportion) <br />

    
    4. <br />
    Use Preset 4 -> Simulate! to repeat the sampling with a larger (70) set of observations and the "Jumpy" prior. 
    
    5.
    Comparing Preset 3 and 4, we find that both estimates suffer similarly from the "Jumpy" prior. The minimum of the prior being very close to the true proportion prevents either from reaching a good estimate in a reasonable time. 
    However, Averaging over many simulations, we find that the smaller standard of deviation for Preset 4 (70 observations) keeps the bulk of the simulation nearer to the true proportion for longer.
    Therefore, Preset 4 will converge to a better estimate faster, while Preset 3 will take many more samples to reach the same quality estimate. <br />
    
    6. 
    Of the first four presets, 2 and 4 are the most similar.
    The part of the distribution that is "squashed" due to the "Jumpy" prior has a smaller effect on the larger observation set than on the small set. <br />
    
    7.
    
    <br />
    
    
    
    <div id="graph2" >
    </div>
    
    
    
</body>
</html>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>


<script src="Hastey.js"></script>

